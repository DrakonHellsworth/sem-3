DROP TABLE IF EXISTS TEAM;
CREATE DATABASE TEAM;
USE TEAM;

CREATE TABLE STUDENT (
SID VARCHAR(10) PRIMARY KEY,
SNAME VARCHAR(17) NOT NULL,
AGE INT NOT NULL
);

CREATE TABLE MATCHES (
MID VARCHAR(10) PRIMARY KEY,
MNAME VARCHAR(20) NOT NULL,
VENUE VARCHAR(30) NOT NULL
);

CREATE TABLE PLAY (
SID VARCHAR(10),
MID VARCHAR(10),
DAY DATE,
FOREIGN KEY (SID) REFERENCES STUDENT(SID),
FOREIGN KEY (MID) REFERENCES MATCHES(MID)
);

INSERT INTO STUDENT(SID,SNAME,AGE) VALUES
('59001','ANMOL',20),
('59002','RAHUL',20),
('59003','KAPIL',20),
('59004','SNIGDH',21);

INSERT INTO MATCHES(MID,MNAME,VENUE) VALUES
('M1','Cricket','Delhi'),
('M2','Football','Mumbai'),
('M3','Hockey','Chennai'),
('M4','Tennis','Delhi');

INSERT INTO PLAY(SID,MID,DAY) VALUES
('59001','M1','2025-01-2'),
('59002','M2','2025-01-4'),
('59003','M3','2025-01-6'),
('59004','M4','2025-01-8'),
('59001','M2','2025-01-10'),
('59002','M4','2025-01-12');

SELECT * FROM STUDENT;
SELECT * FROM MATCHES;
SELECT * FROM PLAY;

-- Q3:
SELECT DISTINCT S.*FROM STUDENT S
JOIN PLAY P ON S.SID=P.SID
WHERE P.MID='M4';

-- Q4:
SELECT DISTINCT M.MNAME FROM MATCHES M
JOIN PLAY P ON M.MID=P.MID
JOIN STUDENT S ON S.SID=P.SID
WHERE S.SNAME='RAHUL';

-- Q5:
SELECT DISTINCT S.SNAME
FROM STUDENT S
JOIN PLAY P ON S.SID=P.SID
JOIN MATCHES M ON M.MID=P.MID
WHERE M.VENUE='Delhi';

-- Q6:
SELECT DISTINCT S.SNAME FROM STUDENT S
JOIN PLAY P ON P.SID=S.SID;

-- Q7:
SELECT S.SID,S.SNAME FROM STUDENT S
JOIN PLAY P1 ON S.SID=P1.SID
JOIN PLAY P2 ON S.SID=P2.SID
WHERE P1.DAY=P2.DAY AND P1.MID<>P2.MID;

-- Q8:
SELECT DISTINCT S.SID FROM STUDENT S
JOIN PLAY P ON S.SID=P.SID
JOIN MATCHES M ON M.MID=P.MID
WHERE M.VENUE IN ('Delhi','Mumbai');

-- Q9:
SELECT AVG(AGE) AS AVG_AGE
FROM STUDENT;