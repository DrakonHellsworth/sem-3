DROP DATABASE IF EXISTS COMPANY;
CREATE DATABASE COMPANY;
USE COMPANY;

CREATE TABLE EMPLOYEES (
    EMPLOYEE_ID VARCHAR(10) PRIMARY KEY,
    FIRST_NAME VARCHAR(30) NOT NULL,
    LAST_NAME VARCHAR(30) NOT NULL,
    DOB DATE,
    SALARY DECIMAL(10,2) NOT NULL,
    DEPARTMENT_ID VARCHAR(10)
);

INSERT INTO EMPLOYEES(EMPLOYEE_ID,FIRST_NAME,LAST_NAME,DOB,SALARY,DEPARTMENT_ID) VALUES
('E101','ANMOL','THAPLIYAL','2002-05-14',40000,'10'),
('E102','RAHUL','MANKANI','2001-06-22',35000,'20'),
('E103','KAPIL','NEGI','1999-11-02',45000,'20'),
('E104','SNIGDH','RAWAL','2003-02-17',30000,'30'),
('E105','AUGUSTYA','THAKUR','2000-09-19',50000,'20');

SELECT * FROM EMPLOYEES;

-- Q1
CREATE VIEW EMP_VIEW AS
SELECT EMPLOYEE_ID,LAST_NAME,SALARY,DEPARTMENT_ID
FROM EMPLOYEES;

SELECT * FROM EMP_VIEW;

-- Q2
ALTER TABLE EMPLOYEES MODIFY FIRST_NAME VARCHAR(30) NULL;
INSERT INTO EMP_VIEW(EMPLOYEE_ID,LAST_NAME,SALARY,DEPARTMENT_ID) VALUES
('E106','ABC',50000,NULL);

SELECT * FROM EMP_VIEW;

-- Q3
UPDATE EMP_VIEW
SET SALARY=67000
WHERE EMPLOYEE_ID='E101';

DELETE FROM EMP_VIEW
WHERE EMPLOYEE_ID='E104';

DROP VIEW EMP_VIEW;

-- Q4
CREATE VIEW SALARY_VIEW AS
SELECT EMPLOYEE_ID,FIRST_NAME,LAST_NAME,DEPARTMENT_ID,(SALARY*12) AS ANNUAL_SALARY
FROM EMPLOYEES
WHERE DEPARTMENT_ID='20';

SELECT * FROM SALARY_VIEW