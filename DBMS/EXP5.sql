DROP DATABASE IF EXISTS SUP;
CREATE DATABASE SUP;
USE SUP;

CREATE TABLE SUPPLIER (
SCODE VARCHAR(9) PRIMARY KEY,
SNAME VARCHAR(23) NOT NULL,
SCITY VARCHAR(30) NOT NULL,
TURNOVER DECIMAL(10,2)
);

CREATE TABLE PART (
PCODE VARCHAR(9) PRIMARY KEY,
WEIGHT INT NOT NULL,
COLOR VARCHAR(13) NOT NULL,
COST  DECIMAL(9,3) NOT NULL,
SP DECIMAL(9,3) NOT NULL
);

CREATE TABLE SUPPLIER_PART (
    SCODE VARCHAR(9),
    PCODE VARCHAR(9),
    QTY INT,
    FOREIGN KEY (SCODE) REFERENCES SUPPLIER(SCODE),
    FOREIGN KEY (PCODE) REFERENCES PART(PCODE)
    );

INSERT INTO SUPPLIER(SCODE,SNAME,SCITY,TURNOVER) VALUES
('59001','ANMOL','DEHRADUN',1000),
('59002','RAHUL','AJMER',1001),
('59003','KAPIL','HARIDWAR',1002),
('59004','AUGUSTYA','LUCKNOW',1003);

INSERT INTO PART(PCODE,WEIGHT,COLOR,COST,SP) VALUES
('50001',20,'Red',20,25),
('50002',30,'Blue',40,50),
('50003',25,'Green',30,45),
('50004',40,'Black',60,80);

INSERT INTO SUPPLIER_PART(SCODE,PCODE,QTY) VALUES
('59001','50001',100),
('59002','50002',150),
('59003','50002',200),
('59004','50003',50);

-- Q1
SELECT SCODE, PCODE
FROM SUPPLIER_PART
ORDER BY SCODE ASC;

-- Q2
SELECT *
FROM SUPPLIER
WHERE SCITY='Bombay' AND TURNOVER=50;

-- Q3
SELECT COUNT(*) AS TOTAL_SUPPLIERS
FROM SUPPLIER;

-- Q4
SELECT PCODE
FROM PART
WHERE WEIGHT BETWEEN 25 AND 35;

-- Q5
SELECT SCODE
FROM SUPPLIER
WHERE TURNOVER IS NULL;

-- Q6
SELECT PCODE
FROM PART
WHERE COST IN (20,30,40);

-- Q7
SELECT SUM(QTY) AS TOTAL_QTY
FROM SUPPLIER_PART
WHERE PCODE='50002';

-- Q8
SELECT SNAME
FROM SUPPLIER
WHERE SCODE IN (
    SELECT SCODE FROM SUPPLIER_PART WHERE PCODE='50002'
);

-- Q9
SELECT PCODE
FROM PART
WHERE COST>(SELECT AVG(COST) FROM PART);

-- Q10
SELECT SCODE, TURNOVER
FROM SUPPLIER
ORDER BY TURNOVER DESC;