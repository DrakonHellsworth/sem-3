from googleapiclient.discovery import build
import pandas as pd
api_key = "api key"
youtube = build("youtube", "v3", developerKey=api_key)
video_ids = [
"--65FMJTKGLs",
"-88ptUOMCBA",
"-FKNbdY2OXI",
"00_dmzXpCco",
"04v4qWVtdPs",
"0bS7p3e6Lb4",
"0roQUZvU-As",
"1JgBp7dX4AU",
"1Tx7FgZuV3U",
"1Un08ziq82Y",
"20y1H6eGHuY",
"2E_O_CR9FA8",
"2NPGrKItt3E",
"2Ut0F4a9dQk",
"2WZ1PZ7imrI",
"2cXHwkQqgU8",
"2dAp1PmhH8g",
"2zwOJdl0xSA",
"33UMkPe93Ko",
"3BRP4wcSCM0",
"3hYe6isTynk",
"41sgRP0G6y4",
"451V-lBLfuo",
"47USKNRqHUQ",
"4begfsf9AQY",
"54IteWmegk0",
"59R1WN4tHrM",
"5Q_6--XsIgA",
"5eW1ah2ah0o",
"6OknnFuDQE8",
"6kARg-Use4Y",
"6mbDM4pidqM",
"85-p9EIEVUA",
"8RxmRw1kCrc",
"8Zpi9V0_5tw",
"8aaXZDazPxs",
"8foQERR0mc0",
"8mdiKI8We5U",
"9-E7koihWF4",
"9-ThusbaRW8",
"9CRhdbDkwXM",
"9EkUvuHBm38",
"9Oc1ErVFk1Q",
"9k7zywli4Vg",
"A9oVP085vMo",
"ABjRnSYw-4k",
"ADM4oxBCkVk",
"AXOa66-k9MA",
"AbXzUTUtG3k",
"Aq97tTeGl14",
"BS9hUQAzELo",
"BnxG0RqP080",
"CNAWnZ49QhU",
"CSu0cV3fqi8",
"CvUIQuAlsWw",
"D3_0vHJVHHo",
"DIILDg2d3Yk",
"DSuva0TtdYs",
"Dh8Yd0mQnB8",
"DjcS1kRkc6M",
"DkkqhzatasI",
"DlQskUgzlHM",
"Dm1tTSZHj8Y",
"Do9eV2zHtiA",
"Dpinb2tunls",
"DzVoGhPN8Ag",
"E0ejkkFT3V0",
"E1W72yddW64",
"Ek1buV2HA68",
"EmqZBBuTMjA",
"F64xcPKKES8",
"FAs0d6q-MS0",
"FM4YYgHhhwQ",
"FXfrncRey-4",
"GHCc9b2phn0",
"GHsQl-k3syg",
"GOuZkYDQjpc",
"GRD-xvlhGMc",
"Gc8_pN7EiRE",
"Gk6gVtyzRS4",
"Gta43oOV4Ag",
"H-MAfcL-JHQ",
"HYIXgmOABbk",
"HdX09d1k0uk",
"HodWkE0G28M",
"Hr6GPYCHTfA",
"HrduBZ319XI",
"I821oI3Ezjs",
"I9q-7GPQr1Y",
"IKEJl93CRLQ",
"IcTNIk0yfj0",
"IjqKcGK-ccY",
"Iu_7V2gaYZk",
"IwD5vmJD7vM",
"J9CvdSvz6sc",
"JFFhD5HeByM",
"JRQSbK4Krg0",
"K9XZCJCAyOE",
"L0Le8bT1RLE",
"LBxeKFuGxJA",
"Lcf74nxpSQE",
"LmjcQ9UoBjc",
"LxLgmsmvXOE",
"M0rP-Gii0Ls",
"MGjQf1MDl_4",
"N7d_RWyOv20",
"NLs5d42albM",
"NUCru4p15-4",
"NiJeB2NJy1A",
"O97lI8FVEas",
"OHofLKUMlI8",
"OU4VoE15wIw",
"Oa5jQWJaFoQ",
"Oc27GxSD_bI",
"PCuyCJocJWg",
"POhEsmYHgHs",
"PnJI07fXWAs",
"Q-roUNTTyVg",
"Q089i8RQPB0",
"Q8bn-NXgOOk",
"QYa1MPhLQ20",
"RRC4Otb4kJk",
"RnSUaZEwYq4",
"S00l8CTpQAQ",
"SSdsncLXLYs",
"SdySHadrYAA",
"SpaNgbS06kE",
"TDYDdr4HVdQ",
"TQxmptAXkeo",
"T_WEYOMDT2I",
"TbOFzPgOhyE",
"TcDvfAECkdA",
"USmu0scNcSs",
"UiJiXNEm-Go",
"UjFkIy1GTlk",
"UphR3i_h01Y",
"V2XvgUcbUFE",
"VAA_dNq_-8c",
"VDkKqHG1BFE",
"VMJPHqwv41U",
"VbeM8Lf7s5A",
"VfbUccGt8vA",
"VikegclJiDM",
"VvqajwOOmpM",
"Vx0MhpSh1TM",
"WZ_Kvw8n758",
"WainnKKtGZI",
"WdS4JU17HRs",
"Wea7Gc-b0EA",
"WrX2QVJ2c3Q",
"XM18MKxf3QA",
"Xp6bxCh_p7c",
"Y1LbQBgvISs",
"YXd4z3gWyVE",
"Z92-7AY_S1A",
"Z99bsizp4bY",
"ZTbW5rVkf1g",
"Zmbe4Wsjpik",
"_18avidXxqY",
"_2Ut8rMdFAQ",
"_34bYpxK_OE",
"_KKql1QvOHY",
"_g5EUBZQXL4",
"_mXh6ERAK4A",
"a8AuaeqeM3s",
"aF3wWWRprP4",
"aQsl5xCrjcA",
"akjQbPKKD7I",
"ampB1laCWF4",
"ap7-Wci2-8k",
"aqKGJgZyiHw",
"b-ovce59oo8",
"bNYkAhbWKqI",
"bcFrI87MNfI",
"bhyoWw2nxfc",
"buVUvnM_AzU",
"c6Eq2sI1NDY",
"cCE1i2tJQQY",
"c_5duGCFCdk",
"ccO0_hSXMyM",
"cpy4V2Bk0jc",
"d1sGo8w6Lpw",
"d2TDXKfBaMQ",
"dWAO3vUn7nw",
"e3bqrBVvqAE",
"e_lhfFKF-G0",
"fCe6UyNyPTg",
"fE6TbXCJ8q4",
"ftHomiQRhMA",
"fundOLJehWA",
"g1Ld8D2bnJM",
"g275afit9l0",
"g4a7_HH9Wbg",
"g77y-6TnH_4",
"gHYkxP0nriQ",
"gOT8J_fqyos",
"gUPbysSt7XU",
"hFkiMWrA2Bc",
"hZjFYFWZJe4",
"hghIckc7nrY",
"i5QIazhw2Ns",
"i6WxIblKVZI",
"iPDQaEP8E6o",
"idiCtICGlCA",
"ieDIpgso4no",
"iijaF1d7pzI",
"ilbOrNrAhOA",
"ingRbhtr5T0",
"jbgvQNhFDTo",
"jtp71NT0GNg",
"k0tnqPmwWvk",
"kTNoXCP77Fo",
"kiifM9APMNQ",
"ksmRZozo3jQ",
"kyd2ayCMu6s",
"lBRWTiE5CDQ",
"lK2iJe7AM_Q",
"m78_sOEadC8",
"mHmIVw9etns",
"mLYMAkgvZsI",
"mdjTmI5kGfU",
"n2RhC4JNS7M",
"nAft5e9AlG8",
"nLqknC6ghIs",
"nadkOPhS-Bs",
"nlwvShR12VM",
"nrXhK3Gh5EE",
"oCa_b9lpZhU",
"oIuvIDhcs8E",
"oP9hoS2dmCM",
"oZSUxdzgA08",
"odl6NK0FDnY",
"oq6HFcFS2IE",
"ot4_jVFXxUU",
"oxbuFwW5f-Q",
"p8oqDwb4zj8",
"pB-qAwkgfFQ",
"pS5Cvpz7-i4",
"pTMyqSFTBrg",
"piPbnKdve9M",
"ppNnz4tfuIA",
"psp_8xJfeWU",
"q1_AJWZajEk",
"q2tJqO6nCSc",
"q67vH0SKahU",
"q8X2gcPVwO0",
"qFOX3AO2FjE",
"qIp9kItDUh8",
"qJuhi6zn1ZY",
"qXJ0FRHHEZI",
"qgIm96-WkwY",
"qplG78Guaa4",
"qqXtPNDCuVk",
"rG7N_Zv6_gQ",
"rKwK06stPS8",
"rhMSQ835hQg",
"ri49dTluKPU",
"rk-6wHimbUs",
"rlWIzZHqgpM",
"rut6fr28TlE",
"sFbghkE0WYo",
"sMowoWNX8iY",
"sOhdQNjmK_U",
"sSmVVDxrc2Y",
"smygOm4S9W4",
"tq7KarjTwTA",
"ttM_g3lxST0",
"u3BKM9vbZDA",
"uSzQPAzOoYg",
"uXmnxhYQ_Iw",
"umckL4diXxU",
"v6k7yBBhuZo",
"va0wtGBEmVM",
"vydgkCCXbTA",
"w5UMyck8D64",
"wSMuhEJRoWE",
"wdfF-doIVjo",
"wqH1F96OBWo",
"x4GqoH4belA",
"x4ySPDvebes",
"xSAnySixRjA",
"xajY7zKIMDA",
"xsikwXnUcBs",
"xyXpQxz7BOs",
"y-E_DC8KGW4",
"y8E61LsJOrI",
"yFRPhi0jhGc",
"z0JpgEOLezY",
"z8K1hEtaQIw",
"z8evo1jr5Nk",
"zfqpYDVhXd8",
"zjLOXG0NMEE"
]
rows = []
for vid in video_ids:
    print("Scraping:", vid)
    try:
        v = youtube.videos().list(part="snippet", id=vid).execute()
        if not v["items"]:
            continue
        title = v["items"][0]["snippet"]["title"]
    except:
        continue

    try:
        req = youtube.commentThreads().list(
            part="snippet",
            videoId=vid,
            maxResults=100,
            textFormat="plainText"
        ).execute()
    except:
        continue

    for item in req.get("items", []):
        s = item["snippet"]["topLevelComment"]["snippet"]
        rows.append({
            "Video ID": vid,
            "Comment (Actual)": s.get("textOriginal", "").replace("\n", " "),
            "Comment Author": s.get("authorDisplayName", ""),
            "Comment Time": s.get("publishedAt", ""),
            "Video Title": title
        })

pd.DataFrame(rows).to_csv("YT_Videos_Comments_100k.csv", index=False)
print("Done! Exported to YT_Videos_Comments_100k.csv")
